
# References:
# https://linuxconfig.org/how-to-create-systemd-service-unit-in-linux
# https://www.linux.com/tutorials/systemd-services-beyond-starting-and-stopping/
[Unit]
Description=Radeon Data Center Daemon (rdcd)
After=network.target

# Add any services that must be started before rdcd here
#After=

# Add any non-service units required by rdcd here
#Requires=

[Service]
User=rdc
Group=rdc

Type=simple

# Needed for accessing fields 700-799 provided by ROCMTools
# At the time of writing - rdcd will crash if these metrics are accessed
# without the following environment variable
Environment=ROCMTOOLS_METRICS_PATH=/@CPACK_PACKAGING_INSTALL_PREFIX@/libexec/rocmtools/counters/derived_counters.xml

CapabilityBoundingSet=CAP_DAC_OVERRIDE
AmbientCapabilities=CAP_DAC_OVERRIDE

# If we need to start anything before rdcd, use this
# ExecStartPre=

ExecStart=/@CPACK_PACKAGING_INSTALL_PREFIX@/@CMAKE_INSTALL_BINDIR@/rdcd

# If we need to start anything after rdcd use this
# ExecStartPost=

# If we want to change the default time out for the ExecStop (90 sec),
# we can modify that time limit with TimeoutStopSec
# TimeoutStopSec=

# Note, we can have multiple ExecStop commands if necessary
ExecStop=/bin/kill -15 $MAINPID
#ExecReload=
#ExecStartPost=
#ExecStopPost=

# StandardOutput=journal
# StandardError=inherit

[Install]
WantedBy= multi-user.target
